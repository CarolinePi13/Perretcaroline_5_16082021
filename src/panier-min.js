const displayAnEmptyCart=()=>{document.getElementById("actualiser").classList.add("btn--hidden");return document.getElementById("CartTable").innerHTML='\n      <p class="empty-cart text-center">Oh! Votre panier est vide!</p>\n      <i class="far fa-sad-tear"></i>\n      <div class="btn fillUP btn-sub"><a href="index.html">Retour à la boutique!</a></div>'},getAllStorage=()=>{if(null===localStorage.getItem("produit")){return displayAnEmptyCart(),[]}{let e=[];return e.push(localStorage.getItem("produit")),JSON.parse(e)}};getAllStorage();let basketItems=getAllStorage();const sousTotal=(e,t)=>e*t,addStorageToPage=()=>{if(basketItems.length>0){const e=basketItems.map((e=>`\n          <div class="cart">\n          <div class="cart_img_supp">\n            <div class="cart_img">\n                <img src="${e.ImgArticle}" class="img-fluid rounded-start img-size" alt="${e.ImgArticle}">\n            </div>\n            <div class="cart-middle">\n              <p class="card-title mt-3 mt-sm-0">${e.NameArticle}</p>\n              <div class="CartItem-price--unit">${e.PriceArticle} €</div>\n              <div class="CartItem-quantity mt-2 mt-sm-0">\n                <select  attr-rctcode="${e.IdArticle} aria-label="quantité de l'article, selectionner une quantité pour la modifier">\n\n                  <option id="selected"value="${e.QuantiteArticle}" selected="selected">${e.QuantiteArticle}</option>\n                  <option value="1">1</option>\n                  <option value="2">2</option>\n                  <option value="3">3</option>\n                \n                </select>\n              </div>\n            </div>\n            <button type="button" aria-label ="supprimer l'article" value="suppress" class="suppress-btn mt-5 mt-sm-0"><i class="fas fa-trash-alt"></i></button>\n          </div> \n            \n          <div class="item-price">\n          \n              \n              <input type="hidden" name="productCode" value="${e.IdArticle}">\n            \n              \n          </div>\n        \n  \n          `)).join(" ");document.querySelector("#CartTableBody").innerHTML=e}};getAllStorage(),addStorageToPage();const getAllPrices=()=>{let e=[];for(let l of basketItems){let r=(t=parseInt(l.PriceArticle),a=parseInt(l.QuantiteArticle),t*a);e.push(r)}var t,a;return e.reduce(((e,t)=>e+t),0)},displayNewTotal=()=>{let e=getAllPrices();document.querySelector(".total-produit").innerText=`\n      Total commande : ${e}.00 €\n\n      `};displayNewTotal();const removeArticleFromCart=async()=>{await addStorageToPage();let e=document.querySelectorAll(".suppress-btn"),t=Array.from(e);for(let e=0;e<t.length;e++)t[e].addEventListener("click",(()=>{let t=basketItems[e],a=basketItems.filter((e=>e!==t));basketItems=a,localStorage.setItem("produit",JSON.stringify(basketItems)),addStorageToPage(),removeArticleFromCart()}));0==basketItems.length&&displayAnEmptyCart(),displayNewTotal()};removeArticleFromCart();const changeQuantite=()=>{document.getElementById("actualiser").addEventListener("click",(()=>{let e=Array.from(document.querySelectorAll("select"));for(let t=0;t<basketItems.length;t++){let a=parseInt(e[t].value);basketItems[t].QuantiteArticle=a}localStorage.setItem("produit",JSON.stringify(basketItems)),getAllStorage(),addStorageToPage(),displayNewTotal(),removeArticleFromCart()}))};document.getElementById("actualiser").addEventListener("click",(()=>{let e=Array.from(document.querySelectorAll("select"));for(let t=0;t<basketItems.length;t++){let a=parseInt(e[t].value);basketItems[t].QuantiteArticle=a}localStorage.setItem("produit",JSON.stringify(basketItems)),getAllStorage(),addStorageToPage(),displayNewTotal(),removeArticleFromCart()}));let inputs=document.querySelectorAll("input[type='text'], input[type='email']"),formulaire=document.querySelector("form");const checkAndSend=()=>{formulaire.addEventListener("submit",(e=>{e.preventDefault();var t=!0;if((()=>{for(let a of inputs){if(!(t=t&&a.reportValidity())){e.preventDefault(),a.nextElementSibling.classList.add("show");break}if(" "==a.value||a.value.length<2){t=!1,e.preventDefault(),a.nextElementSibling.classList.add("show");break}}})(),0===basketItems.length)alert("Votre panier est vide!");else if(t){e.preventDefault();let t=getAllPrices();localStorage.setItem("totalPrice",JSON.stringify(t));let l={firstName:inputs[0].value,lastName:inputs[1].value,address:inputs[3].value,city:inputs[4].value,email:inputs[2].value},r=[];for(let e of basketItems)r.push(e.IdArticle);var a={method:"POST",headers:{"Content-Type":"Application/json"},body:JSON.stringify({contact:l,products:r}),mode:"cors"};(()=>{fetch("http://localhost:3000/api/cameras/order",a).then((e=>e.json())).then((e=>{let t=e.orderId;localStorage.setItem("order",JSON.stringify(t)),window.location.href="./thanksorder.html"}))})(),checkAndSend()}}))};checkAndSend(),inputs.forEach((e=>{e.addEventListener("input",(()=>{e.validity.valid&&(e.nextElementSibling.classList.remove("show"),e.classList.add("error"))}))}));